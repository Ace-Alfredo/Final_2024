---
title: "Covid91 vaccine study Final2024"
author: "Alfredo Acevedo"
output: 
  html_document:
    number_sections: true
    toc: true
    toc_depth: 5
date: "`r Sys.Date()`" 
---

```{r include=FALSE,echo=FALSE}
require(tidyverse)
require(tigerstats)
require(forcats)
OldData <-read.csv(file="final.csv",header=TRUE)
#recode to remove the annoying "X" from the dataframe
FinalData <- FinalData %>% mutate(infected = recode(infected, aids = "covid", none = "OK" )) %>% select(-one_of("X"))
FinalData <- FinalData %>%
mutate(across(where(is.character), as.factor))
FinalData$treatment <- relevel(FinalData$treatment,ref="placebo")
#FinalData$infected <- relevel(FinalData$infected,ref="OK")
Male = filter(FinalData, sex =="M")
Female = filter(FinalData, sex =="F")
LGBTQ = filter(FinalData, LGBTQ =="gay")
Druggies = filter(FinalData, DrugUser =="yes")
```

# Introduction

A new  preventative vaccine (covid921) is under test in clinical trials. Given the nature of this vaccine it is suspected that the drug may exhibit different effectiveness across the variety of subpopulations tracked. Consider population subgroups by gender( guys and gals), drug use, and sexual orientation. Write a complete report that separately considers this drug for each subgroup and your recommendations as to whether people in the subgroup should take the vaccine. Structure your report in four sections each devoted to one of the four subgroups, use null and alternative hypothesis statements and correct statistical verbage when referencing p-values in conclusions.

## Males
  
```{r}
dd2 <- Male %>% group_by(infected,treatment) %>% summarize(count=n()) %>% mutate(prcnt=count/sum(count))


# the group_by followed by summarize(count=n())

basicN <- ggplot(dd2,aes(x=infected,y=count,fill=treatment))
basicN + geom_bar(stat="identity",position="dodge")

#Now for percentage plot

basicCC <- ggplot(dd2,aes(x=infected,y=prcnt*100,fill=treatment)) 
basicCC + geom_bar(stat="identity", position ="dodge")
```
This plot represents the population of males people and the relationship to the contraction of covid-19 by either talking the vaccine or the placebo. 


The plot above shows that a shocking 58% of the male that took the vaccine did in fact get covid-19, while only approximately 42% of the male taking the placebo contracted covid-19.  A substantially higher percentage of males who took tha vaccine contracted covid-19 versus those who were only given the placebo. The vaccine appears to be ineffective in protection against covid-19. The odds of getting covid-19 while taking the vaccine is 3:2. The males that took the drug were one and half times more likely to get covid-19 than those taking the placebo.


There are two plots. In first plot,the x-axis represents infected, whether the participants were infected with covid-19 or they were not. The y-axis represents the count, or number of males that got covid-19 or not.
In the second plot, the one above, The The left two bars of the graph are all the male that got covid-19. The x-axis represents whether a person got covid-19 or not. The y-axis, however, instead of representing the number of male who got covid-19, now represents the percentage of male that got covid-19 after taking the the placebo or taking the Vaccine. 


The codes that  create this plot start with the code block beginning with dd2. dd2 can be seen in the environment pane and if inspected contains 4 variables.These variables include infected, treatment, count, and prcent(stands for percent). The second group of codes is called the basicC. BasicC can also be seen in the environment pane and appears to contain a list of 9 variables. This information creates the first plot. The basicCC is the last bunch of codes and is also in the files pane. It also contains 9 variables and helps to create the percentage plot, the second plot.


### Numerical results

```{r}
table1 <- xtabs(~infected + treatment, data=Male)
rowPerc(table1)
colPerc(table1)
```
These numerical results show specific percentages of male that got covid-19 after taking the placebo and taking the vaccine. 
Among the males, 58% got covid-19 after taking the vaccine, while the approximately 42% of males that were given the placebo contracted covid-19. The vaccine is clearly not effective in preventing covid-19 in males and it is not recommended. Those who took the placebo were much less likely to contact covid-19
The odds of getting covid-19 while taking the vaccine is 3:2. The males that took the drug were one and half times more likely to get covid-19 than those taking the placebo.


### Inferential 



```{r}
chisq.test(table1)
chisqtestGC(table1)
Malefish <- fisher.test(table1)
Malefish
```

The information to play close attention to among all of these results is the output of the Fisher's Exact test. The p-value displayed above is extremely small at 6e-04. This is an awfully small number. seeing this number means that these results are not likely to occur by chance.



The null hypothesis predicted that the deaths related to covid-19 are independent of sex. Since it is clear that sex does play a role in the death rate of individuals, the alternative hypothesis, that there is a correlation between covid-19 deaths and sex, is the favorable option.

The odd ratio above illustrates a ratio of 0.68. the males who received the vaccine were 1.5 times more likely to get covid-19 than those who received the placebo. 




```{r}
effect <- Malefish$p.value/(Malefish$p.value +1)
effectivenessMale = Malefish$estimate/(Malefish$estimate +1)*100
print(effectivenessMale)
```

```{r}
low=(Malefish$conf.int[1]/(Malefish$conf.int[1] +1))*100
hi=(Malefish$conf.int[2]/(Malefish$conf.int[2] +1))*100
options(digits=2)
```


## Effectiveness Confidence Interval `r low`  to `r hi`

Above is the effectiveness for the covid-19 vaccine for males. If the effectiveness is above 50% that means that the vaccine is effective. Based on the interval seen above, we cn conclude that the vaccine is ineffective in protecting males from getting covid-19. 

The odds ratio is approximately how effective the vaccine is. The odds ratio for the males can be seen above as 40. The effectiveness confidence interval for the males is 35.09 to 45.94.



## Females

### Barplot

```{r}
dd2 <- Female %>% group_by(infected,treatment) %>% summarize(count=n()) %>% mutate(prcnt=count/sum(count))


# the group_by followed by summarize(count=n())

basicC <- ggplot(dd2,aes(x=infected,y=count,fill=treatment))
basicC + geom_bar(stat="identity",position="dodge")

#Now for percentage plot

basicCC <- ggplot(dd2,aes(x=infected,y=prcnt*100,fill=treatment)) 
basicCC + geom_bar(stat="identity", position = "dodge")
```


This plot represents the population of females people and the relationship to the contraction of covid-19 by either talking the vaccine or the placebo. 

In this plot, contrary to the previous, it appears that more female who were only given the placebo contracted covid-19. Only approximately 33% of the individuals who were given the vaccine were reported to have contracted covid-19. That means around 67% of the female that got covid-19 were the individuals that only received the placebo.The odds of getting covid-19 while taking the vaccine is 1:5. The female that took the vaccine were half as likely to get covid-19 than those taking the placebo.


There are two plots. In first plot,the x-axis represents infected, whether the participants were infected with covid-19 or they were not. The y-axis represents the count, or number of people that got covid-19 or not.
In the second plot, the one above, The The left two bars of the graph are all the people that got covid-19. The x-axis represents whether a person got covid-19 or not. The y-axis, however, instead of representing the number of female who got covid-19, now represents the percentage of female that got covid-19 after taking the the placebo or taking the Vaccine. 



The codes that  create this plot start with the code block beginning with dd2. dd2 can be seen in the environment pane and if inspected contains 4 variables.These variables include infected, treatment, count, and prcent(stands for percent). The second group of codes is called the basicC. BasicC can also be seen in the environment pane and appears to contain a list of 9 variables. This information creates the first plot. The basicCC is the last bunch of codes and is also in the files pane. It also contains 9 variables and helps to create the percentage plot, the second plot.





## LGBTQ



## Druggies


# Overall Results and Conclusions



